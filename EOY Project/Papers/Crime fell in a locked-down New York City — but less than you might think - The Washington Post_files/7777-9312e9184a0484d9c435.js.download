(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7777],{72594:function(e,s,t){"use strict";t.d(s,{Z:function(){return f}});var a=t(26265),n=t(67294),r=t(29208),i=t.n(r),o=t(23561),l=t(71033),c=t(38903),d=n.createElement;var b=t(60200),u=t(26934),m=n.createElement;function g(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);s&&(a=a.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,a)}return t}function p(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?g(Object(t),!0).forEach((function(s){(0,a.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}class h extends n.Component{constructor(e){super(e),(0,a.Z)(this,"checkDisplayStatus",(e=>{!0===e.readyDisplay&&(6===this.state.action&&(window.wpMetaData.sct_tags+=this.state.sct_tags,window.extListener&&window.extListener({action:this.state.action}),window.registerDisplay({participant:"osn",status:"final"})),this.setState({displayReady:!0}))})),(0,a.Z)(this,"checkUserMessages",(({action:e,osnAction:s})=>{if(e>0)return Promise.resolve();const t=this.props.siteProperties.account.osnUrl[(0,b.Z)()];return(0,c.$8)()?fetch(t,{credentials:"include"}).then((e=>e.json())).then((e=>this.parseMessages(e,s))).catch((()=>{this.generatePwapiOsns(s)})):(this.generatePwapiOsns(s),Promise.resolve())})),(0,a.Z)(this,"checkPwapiAndOSNMessage",(e=>{if("final"===e.status&&0===e.action){this.setState({showOSN:!1,action:e.action});let t={};try{t=JSON.parse(localStorage.getItem("wapo_identity")||"{}")}catch(s){console.warn("[OSN] Error parsing wapo_identity from local storage",s)}const a=t.flags||[];this.checkUserMessages({osnAction:0,action:e.action||0}).then(((s=[])=>{s.some((e=>["CANCEL","SUSPEND"].includes(e)))||s.length&&e.data&&!e.data.isSubscriber?this.setState({showOSN:!0}):s.some((e=>["START"].includes(e)))&&!a.includes("cp_selected")&&e.data&&e.data.isSubscriber&&(this.setState({action:6}),this.setState({sct_tags:`,${a.join(",")},onboarding`}))})).finally((()=>{window.registerDisplay({participant:"osn",status:"ready"})}))}else"error"===e.status&&window.registerDisplay({participant:"osn",status:"final"})})),(0,a.Z)(this,"getTimingValues",((e,s)=>{if(!e)return{};const t=e-s,a=e-(new Date).getTime(),n=(new Date).getTime()-s,r=Math.floor(a/t);let i=a/36e5;i=i>0?Math.round(i):0;let o=a/864e5;o=o>0?Math.round(o):0;const l=n/864e5;return{validUntil:new Date(e).toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"}),daysRemaining:o,daysSince:l,hoursRemaining:i,fractionRemaining:r}})),(0,a.Z)(this,"generateOsnUi",(e=>{const s=this.getTimingValues(e.messageExpire||e.expirationDate,e.messageDate),t=function(e){return{START:[{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Get the most from your subscription. Access exclusive features in our mobile app.")),button:d("a",{href:"https://wapo.onelink.me/e76N/subsosn?itid=ntfn_start_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Read in App"),reason:"ntfn_start_2",gaReason:"on_start_2",classNames:"bg-blue white",trigger:"daysSince",thresholds:[4,32,62,92,122,152]},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Get the most from your subscription. Update your email newsletters and alerts any time.")),button:d("a",{href:"https://subscribe.washingtonpost.com/newsletters/#/newsletters?method=MP&location=WELE_ON&tid=ntfn_start_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Update now"),classNames:"bg-blue white",reason:"ntfn_start_1",gaReason:"on_start_1",trigger:"daysSince",thresholds:[2,30,60,90,120,150]}],FIRSTUPC:[{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Thanks for reading.\xa0"),d("div",{className:"dib-l"},"Try one month of unlimited access for"," ",d("span",{className:"o-50 strike"},"$10")," $1.")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition/?promo=o16&tid=ntfn_first_upc",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"View Offer"),reason:"ntfn_first_upc",gaReason:"on_first_upc",classNames:"bg-blue white",show:"once"}],SUSPEND:[{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"We were unable to process your last payment.\xa0"),d("div",{className:"dib-l"},"Update your payment method to keep your access.")),button:d("a",{href:"https://subscribe.washingtonpost.com/profile/#/profile/digitalsubscription?tid=ntfn_suspended_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Update my payment"),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_1",gaReason:"on_suspend_1",show:"once"},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Your account still has payment issues.\xa0"),d("div",{className:"dib-l"},"Update your payment method to keep your access.")),button:d("a",{href:"https://subscribe.washingtonpost.com/profile/#/profile/digitalsubscription?tid=ntfn_suspended_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Update my payment"),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_2",gaReason:"on_suspend_2",trigger:"fractionRemaining",threshold:.49},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Update your payment method in ",e.hoursRemaining," hours to keep your access.\xa0"),d("div",{className:"dib-l"},"Update your payment method to keep your access.")),button:d("a",{href:"https://subscribe.washingtonpost.com/profile/#/profile/digitalsubscription?tid=ntfn_suspended_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Update my payment"),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_3",gaReason:"on_suspend_3",trigger:"hoursRemaining",threshold:24}],CANCEL:[{message:d(n.Fragment,null,d("div",{className:"dib-l"},"You\u2019ve canceled your subscription.\xa0"),d("div",{className:"bold dib-l"},"Reactivate by ",e.validUntil," to keep access.")),button:d("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"See my rate"),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_1",gaReason:"on_cancel_1",show:"once"},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Reactivate your subscription by ",e.validUntil," to keep access."),d("div",{className:"dib-l"},"\xa0")),button:d("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"See my rate"),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_2",gaReason:"on_cancel_2",trigger:"daysRemaining",threshold:15},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Reactivate your subscription in the next ",e.daysRemaining,"days to keep access."),d("div",{className:"dib-l"},"\xa0")),button:d("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"See my rate"),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_3",gaReason:"on_cancel_3",trigger:"daysRemaining",threshold:7},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"You\u2019ve canceled your subscription and access ends in"," ",e.hoursRemaining,". Reactivate now to keep access."),d("div",{className:"dib-l"},"\xa0")),button:d("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_4",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"See my rate"),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_4",gaReason:"on_cancel_4",trigger:"hoursRemaining",threshold:24}],FREETRIAL:[{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Welcome to your free trial of The Washington Post.\xa0"),d("div",{className:"dib-l"},"Enjoy free digital access until ",e.validUntil,".")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"View offer"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_1",gaReason:"on_free_trial_1",show:"once"},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"We hope you're enjoying your free trial.\xa0"),d("div",{className:"dib-l"},"Subscribe to keep your access past ",e.validUntil,".")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"View offer"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_2",gaReason:"on_free_trial_2",trigger:"fractionRemaining",threshold:.99},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Your free trial expires in ",e.daysRemaining," days.\xa0"),d("div",{className:"dib-l"},"Subscribe to keep your access.")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"View offer"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_3",gaReason:"on_free_trial_3",trigger:"fractionRemaining",threshold:.5},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Your free trial expires in ",e.daysRemaining," days.\xa0"),d("div",{className:"dib-l"},"Subscribe to enjoy your access past ",e.validUntil,".")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_4",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"View offer"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_4",gaReason:"on_free_trial_4",trigger:"fractionRemaining",threshold:.25},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Your free trial expires soon.\xa0"),d("div",{className:"bodl dib-l"},"Subscribe to keep your access past ",e.validUntil,".")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_5",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Renew Now"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_5",gaReason:"on_free_trial_5",trigger:"fractionRemaining",threshold:.05},{message:d(n.Fragment,null,d("div",{className:"bold dib-l"},"Hurry! Your free trial expires in ",e.hoursRemaining," hours. Keep reading for just ",d("span",{className:"o-50 strike"},"$10"),"\xa0$1."),d("div",{className:"dib-l"},"\xa0")),button:d("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_6",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer"},"Renew Now"),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_6",gaReason:"on_free_trial_6",trigger:"hoursRemaining",threshold:24}]}}(s);if(t[e.useCase]){const a=t[e.useCase].filter((t=>{if(e.messageExpire&&e.messageExpire<(new Date).getTime())return!1;if(this.isDismissed(e.id,t.reason))return!1;if(t.trigger&&t.threshold&&s[t.trigger]>t.threshold)return!1;if(t.trigger&&t.thresholds&&Array.isArray(t.thresholds)){const a=t.thresholds.find(((e,a)=>{const n=t.thresholds[a+1];return e<=s[t.trigger]&&(!n||s[t.trigger]<n)}));if(!a)return!1;if(t.reason+=`_${a}`,t.gaReason+=`_${a}`,this.isDismissed(e.id,t.reason))return!1}return t}));if(a&&a.length){e=p(p({},e),a.pop()),this.setState(e);const s=i()(e,"gaReason","");"once"===e.show&&this.dismissMessageLocal(e.id,e.reason),(0,l.Nf)("notification-display","notification",s,{event:"acquisition-notification-display"})}}})),(0,a.Z)(this,"generatePwapiOsns",(e=>{const s=1===e?"FIRSTUPC":null;s&&this.generateOsnUi({useCase:s,id:s})})),(0,a.Z)(this,"parseMessages",((e,s)=>{const t=["CANCEL","SUSPEND","START"];e.messages=e.messages||[];const a=[],n=e.messages.map((e=>(a.push(e.useCase),-1!==t.indexOf(e.useCase)&&("START"===e.useCase&&"Y"===e.isFreeTrial&&(e.useCase="FREETRIAL"),e))));return n.length>0?this.generateOsnUi(n[0]):this.generatePwapiOsns(s),a})),(0,a.Z)(this,"dismiss",(()=>{this.dismissMessageLocal(this.state.id,this.state.reason),(0,l.Nf)("notification-close","notification",this.state.gaReason,{event:"acquisition-notification-close"})})),(0,a.Z)(this,"isDismissed",((e,s)=>i()(this.dismissedMessages,`${e}.reason.${s}`))),(0,a.Z)(this,"dismissMessageLocal",((e,s)=>{this.dismissedMessages[e]=this.dismissedMessages[e]||{},this.dismissedMessages[e].reason=this.dismissedMessages[e].reason||{},this.dismissedMessages[e].reason[s]=!0,localStorage.setItem("userMessages",JSON.stringify(this.dismissedMessages))})),this.state={}}componentDidMount(){this.dismissedMessages=(0,u.e)()&&JSON.parse(localStorage.getItem("userMessages"))||{},window.registerExtUpdates?window.registerExtUpdates(this.checkPwapiAndOSNMessage):(window.extConsumers=window.extConsumers||[],window.extConsumers.push(this.checkPwapiAndOSNMessage)),window.registerDisplay&&window.registerDisplay({participant:"osn",callback:this.checkDisplayStatus})}render(){const{message:e,showOSN:s,classNames:t,button:a,displayReady:n}=this.state;return e&&s&&n?m("div",{style:{marginTop:"60px",position:"absolute",width:"100%",zIndex:"100"},"data-qa":"osn"},m(o.Banner,{classNames:`pa-sm hide-for-print ${t}`,dismiss:this.dismiss,iconClasses:"close brad-50 pa-xxs ml-sm pointer fr",iconFill:"white",iconStyle:{background:"rgba(0,0,0,0.2)"}},m("div",{className:"flex-ns flex-1 items-center"},m("div",{className:"flex-1 justify-start"},m("div",null,e)),m("div",{className:"justify-end"},a)))):null}}var f=h},77449:function(e,s,t){"use strict";var a=t(67294),n=t(61659);class r extends a.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,s){window.Sentry&&window.Sentry.withScope((t=>{t.setExtras(s),window.Sentry.captureException((0,n.Z)(e,"Component"))})),this.setState({hasError:!0})}render(){return this.state.hasError?null:this.props.children}}s.Z=r},61659:function(e,s,t){"use strict";class a extends Error{constructor(e,s){super(),this.name=s,this.message=e}}s.Z=(e,s)=>{const t=`SpectrumReactError ${e.message}`;return new a(t,`SpectrumReactError${s}:`)}}}]);
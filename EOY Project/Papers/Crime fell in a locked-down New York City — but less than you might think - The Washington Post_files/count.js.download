!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";n.r(e),n.d(e,"main",(function(){return f}));var r=".coral-count",o="coral-script";var a=function(t){var e=t.document.querySelector('link[rel="canonical"]');return e?e.href:(console.warn("This page does not include a canonical link tag. Coral has inferred this story_url from the window object. Query params have been stripped, which may cause a single thread to be present across multiple pages."),function(t){return t.location.origin||"".concat(t.location.protocol,"//").concat(t.location.host)}(t)+t.location.pathname)};var c=function(t,e,n){var r=window.document.createElement("script");r.src="".concat(t,"?callback=").concat(e),Object.keys(n).sort().forEach((function(t){var e=n[t];void 0!==e&&(r.src+="&".concat(t,"=").concat(encodeURIComponent(e)))})),window.document.body.appendChild(r)};var u=function(t){var e,n,r=document.currentScript;if(!r&&t&&((r=document.getElementById(t))||(r=document.querySelector(".".concat(t)))),!r)throw new Error("Current script not found");return e=r.src,n=e.split("/"),"".concat(n[0],"//").concat(n[2])};function l(t){var e=t.html,n=t.count,r=t.id,o={coralCount:n.toString()},a=document.createElement("span");if(a.innerHTML=e,r){var c=function(t){var e,n="coral:"+function(t){return"v1:previousCount:".concat(t)}(t);try{var r=localStorage.getItem(n);if(!r)return null;e=parseInt(r,10)}catch(o){return localStorage.removeItem(n),null}return e}(r);if(null!==c&&c<n){var u=n-c;o.coralPreviousCount=c.toString(),o.coralNewCount=u.toString();var l=document.createElement("span");l.className="coral-new-count-divider",l.innerText=" / ",a.appendChild(l);var i=document.createElement("span");i.className="coral-new-count-number",i.innerText=u.toString(),a.appendChild(i);var d=document.createElement("span");d.className="coral-new-count-text",d.innerText=" New",a.appendChild(d)}}return function(t){t.innerHTML=a.innerHTML,t.dataset.coralCount=o.coralCount,o.coralNewCount&&o.coralPreviousCount&&(t.dataset.coralNewCount=o.coralNewCount,t.dataset.coralPreviousCount=o.coralPreviousCount)}}var i=function(t){window.CoralCount={setCount:function(t){var e=document.querySelectorAll("".concat(r,"[data-coral-ref='").concat(t.ref,"']")),n=l(t);Array.prototype.forEach.call(e,(function(t){n(t)}))},getCount:t}};function d(t){return btoa("".concat(t.notext?"true":"false",";").concat(t.id||t.url))}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=u(o),n=a(window),l={},i=document.querySelectorAll(r);Array.prototype.forEach.call(i,(function(e){var r=e.dataset.coralId,o="true"===e.dataset.coralNotext,a=e.dataset.coralUrl;a||r||(a=n,e.dataset.coralUrl=n);var c={id:r,url:a,notext:o},u=e.dataset.coralRef;if(u){if(!t.reset)return}else u=d(c),e.dataset.coralRef=u;u in l||(l[u]=c)})),Object.keys(l).forEach((function(n){var r=l[n],o=r.url,a={id:r.id,url:o,notext:r.notext?"true":"false",ref:n};t.reset&&(a.d=Date.now().toString()),c("".concat(e,"/api/story/count.js"),"CoralCount.setCount",a)}))}function f(){i(s),s()}(function(t){return void 0!==t.CoralCount})(window)||f()}]);
//# sourceMappingURL=count.js.map